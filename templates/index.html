<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Welcome to Bangalore House Price Predictor</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <style>
        :root{--glass-bg: rgba(255,255,255,0.06);--accent-1:#06b6d4;--accent-2:#7c3aed}
        body {
            background: url('https://images.unsplash.com/photo-1560448204-e02f11c3d0e2?auto=format&fit=crop&w=1920&q=80') no-repeat center center fixed;
            background-size: cover;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            color: #fff;
            min-height:100vh;
        }
        .overlay {background-color: rgba(6,6,10,0.42);position: fixed;top: 0;left: 0;width: 100%;height: 100%;z-index: 0}
        .site-header{position:relative;z-index:2;padding:1rem 0;text-align:center;color:#fff;text-shadow: 0 2px 6px rgba(0,0,0,0.6)}
        .brand{font-weight:700;letter-spacing:0.4px}
        .glass-card {background: var(--glass-bg);backdrop-filter: blur(10px);-webkit-backdrop-filter: blur(10px);border-radius: 16px;border: 1px solid rgba(255, 255, 255, 0.08);box-shadow: 0 12px 40px rgba(2,6,23,0.6);padding: 28px;margin-top: 24px;z-index:2}
        .group-box{background:rgba(255,255,255,0.96);padding:14px;border-radius:10px;margin-bottom:12px}
        .group-box label{color:#374151;font-weight:600}
        .form-control, .form-select {background: #fff;border: 1px solid #e5e7eb;border-radius:8px;color:#111}
        .form-control:focus, .form-select:focus {outline: none;box-shadow:0 10px 30px rgba(2,6,23,0.08)}
        .btn-predict {background: linear-gradient(90deg,var(--accent-1),var(--accent-2));border:none;border-radius:10px;padding:10px 18px;font-size:1rem;font-weight:700;color:#fff}
        .btn-predict:hover {filter:brightness(1.02);transform:translateY(-2px)}
        .result-box{margin-top:18px;padding:16px;border-radius:10px;font-weight:700}
        h1 {text-align:center;margin-bottom:18px;font-weight:700;color:#fff}
        .tip{color:rgba(255,255,255,0.85)}
        @media(min-width:768px){.glass-card{padding:34px}}
    </style>
  </head>
  <body>
    <div class="overlay"></div>
    <header class="site-header">
        <div class="container">
            <div class="brand">Bangalore House Price Predictor</div>
            <div class="text-muted small">Estimate prices quickly — tweak UI and try values</div>
        </div>
    </header>
    <main class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-md-9 col-lg-6">
                <div class="glass-card">
                    <h1>Estimate Your Home Price</h1>
                    <form id="predictionForm" novalidate>
                        <div class="group-box">
                            <label for="loc">Location</label>
                            <select class="form-select mt-2" id="loc" name="location" required>
                                <option value="" disabled selected>Choose a location...</option>
                                {% for location in locations %}
                                <option value="{{ location }}">{{ location }}</option>
                                {% endfor %}
                            </select>
                        </div>

                        <div class="row">
                            <div class="col-6">
                                <div class="group-box">
                                    <label for="bhk">BHK</label>
                                    <input type="number" class="form-control mt-2" id="bhk" name="bhk" placeholder="2" min="1" required>
                                </div>
                            </div>
                            <div class="col-6">
                                <div class="group-box">
                                    <label for="bath">Bathrooms</label>
                                    <input type="number" class="form-control mt-2" id="bath" name="bath" placeholder="2" min="1" required>
                                </div>
                            </div>
                        </div>

                        <div class="group-box">
                            <label for="total_sqft">Square Feet</label>
                            <input type="number" class="form-control mt-2" id="total_sqft" name="total_sqft" placeholder="1200" min="100" step="any" required>
                        </div>

                        <div class="d-grid mt-2">
                            <button type="button" class="btn btn-predict" onclick="send_data()">Predict Price</button>
                        </div>

                        <div id="result" class="result-box d-none" role="status"></div>
                    </form>
                </div>
                <div class="text-center tip mt-3 small">Tip: try different location + BHK combinations.</div>
            </div>
        </div>
    </main>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <script>
        function send_data() {
            console.log('send_data called');
            var form = document.getElementById('predictionForm');
            if (!form.checkValidity()) { form.reportValidity(); return; }

            var formData = new FormData(form);
            var resultDiv = document.getElementById('result');
            // show status early (use Bootstrap alert base class)
            resultDiv.classList.remove('d-none');
            resultDiv.classList.remove('alert-danger');
            resultDiv.classList.add('alert','alert-light');
            resultDiv.innerHTML = 'Predicting price...';

            fetch('/predict', { method: 'POST', body: formData })
                .then(function(response) {
                    return response.text().then(function(text) {
                        console.log('fetch /predict response', response.status, text);
                        if (response.ok) {
                            resultDiv.classList.remove('alert-danger');
                            resultDiv.classList.add('alert-light');
                            resultDiv.innerHTML = '<strong>Prediction:</strong> ₹' + text + ' Lakhs';
                        } else {
                            resultDiv.classList.remove('alert-light');
                            resultDiv.classList.add('alert-danger');
                            resultDiv.innerHTML = 'Error: ' + text;
                        }
                    });
                })
                .catch(function(err) {
                    console.error('fetch error', err);
                    resultDiv.classList.remove('alert-light');
                    resultDiv.classList.add('alert-danger');
                    resultDiv.innerHTML = 'Network error. Please try again.';
                });
        }
    </script>
  </body>
</html>